# Integration Tests Guide

Twin:te Front では [Playwright](https://playwright.dev/) を利用した結合テストを実施しています。

## 実行

ブラウザバイナリなどの依存をインストール

```console
yarn playwright install --with-deps
```

テストを実行

```console
yarn test:integration           # ヘッドレスモードで実行
yarn test:integration --headed  # ブラウザを表示して実行
yarn test:integration --ui      # 専用の GUI で実行
```

## 方針

このテストでは最低限のユーザの行動を実行できることを保証します。
例えば以下のような内容です。

- 授業を検索したら授業結果が表示される
- 検索結果でチェックボックスを押すと授業が選択され、追加ボタンがアクティブになり押せる

反対に以下のような網羅性の高さは保証しません。

- 授業検索でそれぞれの時限指定の入力パターンで正しく表示されるか
- スマホ、タブレット、PC のそれぞれで正しく表示されるか
  - Twin:te は 8, 9 割がスマホでの利用なので結合テストでは基本的にスマホのみを対象とします

## 背景

Twin:te Front 過去に重大な不具合が長期間放置されていたことがあります。

- アーキテクチャの以降時にバグが混入し、KdB もどきからのインポートが 3 ヶ月間ほどできない状態で放置されていた
- パッケージアップグレード時にライブラリの仕様が変わり、一部のトグルボタンが半年ほど機能しない状態で放置されていた

これらの不具合は QA をリリース前に行っていれば防げたものである一方、安定した開発リソースが無い Twin:te ではリリース前に毎回 QA を行うことは難しいです。
そこで QA の一部を代替するために結合テストを導入しました。

詳細は [https://github.com/twin-te/twinte-front/issues/689] を参照してください。
